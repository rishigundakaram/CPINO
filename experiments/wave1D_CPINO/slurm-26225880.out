/home/rgundaka/miniconda3/envs/CPINO/lib/python3.10/site-packages/torch/functional.py:568: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  ../aten/src/ATen/native/TensorShape.cpp:2228.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
wandb: Currently logged in as: rishigundakaram. Use `wandb login --relogin` to force relogin
loading data
data is loaded
using device: cuda:0
wandb: wandb version 0.12.19 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.12.18
wandb: Run data is saved locally in /central/groups/tensorlab/rgundaka/code/CPINO/experiments/wave1D_CPINO/wandb/run-20220627_223633-3lq3i8dz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run splendid-lion-15
wandb: â­ï¸ View project at https://wandb.ai/rishigundakaram/CPINO-wave1D
wandb: ğŸš€ View run at https://wandb.ai/rishigundakaram/CPINO-wave1D/runs/3lq3i8dz
  0% 0/100 [00:00<?, ?it/s]loss: 0.00142 weighted data loss: 0.00015 weighted f err: 0.00224 weighted ic err: -0.00047 L2 data loss: 0.07017 L2 ic loss: 0.00761 L2 f loss: 1.92913 :   0% 0/100 [00:42<?, ?it/s]loss: 0.00142 weighted data loss: 0.00015 weighted f err: 0.00224 weighted ic err: -0.00047 L2 data loss: 0.07017 L2 ic loss: 0.00761 L2 f loss: 1.92913 :   1% 1/100 [00:42<1:09:20, 42.03s/it]loss: 0.00134 weighted data loss: 0.00005 weighted f err: 0.00008 weighted ic err: 0.00015 L2 data loss: 0.06769 L2 ic loss: 0.00746 L2 f loss: 2.28846 :   1% 1/100 [01:24<1:09:20, 42.03s/it] loss: 0.00134 weighted data loss: 0.00005 weighted f err: 0.00008 weighted ic err: 0.00015 L2 data loss: 0.06769 L2 ic loss: 0.00746 L2 f loss: 2.28846 :   2% 2/100 [01:24<1:08:56, 42.21s/it]loss: 0.00255 weighted data loss: -0.00005 weighted f err: -0.00184 weighted ic err: 0.00098 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 1.78582 :   2% 2/100 [02:05<1:08:56, 42.21s/it]loss: 0.00255 weighted data loss: -0.00005 weighted f err: -0.00184 weighted ic err: 0.00098 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 1.78582 :   3% 3/100 [02:05<1:07:31, 41.76s/it]loss: 0.00671 weighted data loss: -0.00000 weighted f err: -0.00034 weighted ic err: 0.00141 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 1.38892 :   3% 3/100 [02:45<1:07:31, 41.76s/it]loss: 0.00671 weighted data loss: -0.00000 weighted f err: -0.00034 weighted ic err: 0.00141 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 1.38892 :   4% 4/100 [02:45<1:05:56, 41.22s/it]loss: 0.01118 weighted data loss: 0.00001 weighted f err: 0.00111 weighted ic err: 0.00199 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 1.45756 :   4% 4/100 [03:25<1:05:56, 41.22s/it]  loss: 0.01118 weighted data loss: 0.00001 weighted f err: 0.00111 weighted ic err: 0.00199 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 1.45756 :   5% 5/100 [03:25<1:04:40, 40.85s/it]loss: 0.01407 weighted data loss: -0.00003 weighted f err: 0.00040 weighted ic err: 0.00279 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 1.70649 :   5% 5/100 [04:06<1:04:40, 40.85s/it]loss: 0.01407 weighted data loss: -0.00003 weighted f err: 0.00040 weighted ic err: 0.00279 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 1.70649 :   6% 6/100 [04:06<1:04:05, 40.91s/it]loss: 0.01649 weighted data loss: 0.00001 weighted f err: -0.00056 weighted ic err: 0.00339 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 1.54122 :   6% 6/100 [04:47<1:04:05, 40.91s/it]loss: 0.01649 weighted data loss: 0.00001 weighted f err: -0.00056 weighted ic err: 0.00339 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 1.54122 :   7% 7/100 [04:47<1:03:36, 41.03s/it]loss: 0.02091 weighted data loss: -0.00001 weighted f err: -0.00066 weighted ic err: 0.00433 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 1.27377 :   7% 7/100 [05:27<1:03:36, 41.03s/it]loss: 0.02091 weighted data loss: -0.00001 weighted f err: -0.00066 weighted ic err: 0.00433 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 1.27377 :   8% 8/100 [05:27<1:02:39, 40.87s/it]loss: 0.02606 weighted data loss: 0.00000 weighted f err: -0.00016 weighted ic err: 0.00524 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 1.10676 :   8% 8/100 [06:08<1:02:39, 40.87s/it] loss: 0.02606 weighted data loss: 0.00000 weighted f err: -0.00016 weighted ic err: 0.00524 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 1.10676 :   9% 9/100 [06:08<1:01:53, 40.81s/it]loss: 0.03208 weighted data loss: 0.00000 weighted f err: 0.00006 weighted ic err: 0.00639 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 1.07385 :   9% 9/100 [06:49<1:01:53, 40.81s/it] loss: 0.03208 weighted data loss: 0.00000 weighted f err: 0.00006 weighted ic err: 0.00639 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 1.07385 :  10% 10/100 [06:49<1:01:14, 40.82s/it]loss: 0.03892 weighted data loss: 0.00001 weighted f err: 0.00017 weighted ic err: 0.00773 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 1.00195 :  10% 10/100 [07:29<1:01:14, 40.82s/it]loss: 0.03892 weighted data loss: 0.00001 weighted f err: 0.00017 weighted ic err: 0.00773 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 1.00195 :  11% 11/100 [07:29<1:00:29, 40.78s/it]loss: 0.04707 weighted data loss: 0.00001 weighted f err: 0.00010 weighted ic err: 0.00937 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.94585 :  11% 11/100 [08:10<1:00:29, 40.78s/it]loss: 0.04707 weighted data loss: 0.00001 weighted f err: 0.00010 weighted ic err: 0.00937 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.94585 :  12% 12/100 [08:10<59:50, 40.80s/it]  loss: 0.05722 weighted data loss: 0.00002 weighted f err: 0.00023 weighted ic err: 0.01137 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.83484 :  12% 12/100 [08:52<59:50, 40.80s/it]loss: 0.05722 weighted data loss: 0.00002 weighted f err: 0.00023 weighted ic err: 0.01137 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.83484 :  13% 13/100 [08:52<59:17, 40.89s/it]loss: 0.07006 weighted data loss: 0.00005 weighted f err: 0.00030 weighted ic err: 0.01385 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.76305 :  13% 13/100 [09:34<59:17, 40.89s/it]loss: 0.07006 weighted data loss: 0.00005 weighted f err: 0.00030 weighted ic err: 0.01385 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.76305 :  14% 14/100 [09:34<58:53, 41.09s/it]loss: 0.08568 weighted data loss: -0.00000 weighted f err: 0.00008 weighted ic err: 0.01712 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.45002 :  14% 14/100 [10:16<58:53, 41.09s/it]loss: 0.08568 weighted data loss: -0.00000 weighted f err: 0.00008 weighted ic err: 0.01712 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.45002 :  15% 15/100 [10:16<58:18, 41.16s/it]loss: 0.10649 weighted data loss: 0.00005 weighted f err: -0.00017 weighted ic err: 0.02124 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.56215 :  15% 15/100 [10:58<58:18, 41.16s/it]loss: 0.10649 weighted data loss: 0.00005 weighted f err: -0.00017 weighted ic err: 0.02124 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.56215 :  16% 16/100 [10:58<57:51, 41.33s/it]loss: 0.13433 weighted data loss: 0.00006 weighted f err: -0.00008 weighted ic err: 0.02676 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.44640 :  16% 16/100 [11:41<57:51, 41.33s/it]loss: 0.13433 weighted data loss: 0.00006 weighted f err: -0.00008 weighted ic err: 0.02676 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.44640 :  17% 17/100 [11:41<57:19, 41.44s/it]loss: 0.17167 weighted data loss: 0.00003 weighted f err: -0.00028 weighted ic err: 0.03433 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.36466 :  17% 17/100 [12:26<57:19, 41.44s/it]loss: 0.17167 weighted data loss: 0.00003 weighted f err: -0.00028 weighted ic err: 0.03433 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.36466 :  18% 18/100 [12:26<57:15, 41.89s/it]loss: 0.22379 weighted data loss: 0.00000 weighted f err: -0.00047 weighted ic err: 0.04485 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.28860 :  18% 18/100 [13:11<57:15, 41.89s/it]loss: 0.22379 weighted data loss: 0.00000 weighted f err: -0.00047 weighted ic err: 0.04485 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.28860 :  19% 19/100 [13:11<57:03, 42.27s/it]loss: 0.29849 weighted data loss: -0.00001 weighted f err: -0.00066 weighted ic err: 0.05985 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.32552 :  19% 19/100 [13:59<57:03, 42.27s/it]loss: 0.29849 weighted data loss: -0.00001 weighted f err: -0.00066 weighted ic err: 0.05985 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.32552 :  20% 20/100 [13:59<57:11, 42.89s/it]loss: 0.40842 weighted data loss: -0.00001 weighted f err: -0.00060 weighted ic err: 0.08183 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.31510 :  20% 20/100 [14:48<57:11, 42.89s/it]loss: 0.40842 weighted data loss: -0.00001 weighted f err: -0.00060 weighted ic err: 0.08183 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.31510 :  21% 21/100 [14:48<57:29, 43.67s/it]loss: 0.57632 weighted data loss: -0.00004 weighted f err: -0.00029 weighted ic err: 0.11540 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.28582 :  21% 21/100 [15:40<57:29, 43.67s/it]loss: 0.57632 weighted data loss: -0.00004 weighted f err: -0.00029 weighted ic err: 0.11540 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.28582 :  22% 22/100 [15:40<57:51, 44.50s/it]loss: 0.84345 weighted data loss: 0.00001 weighted f err: 0.00044 weighted ic err: 0.16858 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.30156 :  22% 22/100 [16:30<57:51, 44.50s/it]  loss: 0.84345 weighted data loss: 0.00001 weighted f err: 0.00044 weighted ic err: 0.16858 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.30156 :  23% 23/100 [16:30<57:53, 45.12s/it]loss: 1.28988 weighted data loss: 0.00013 weighted f err: 0.00091 weighted ic err: 0.25754 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.32005 :  23% 23/100 [17:22<57:53, 45.12s/it]loss: 1.28988 weighted data loss: 0.00013 weighted f err: 0.00091 weighted ic err: 0.25754 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.32005 :  24% 24/100 [17:22<58:08, 45.90s/it]loss: 2.08264 weighted data loss: 0.00025 weighted f err: -0.00018 weighted ic err: 0.41606 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.32830 :  24% 24/100 [18:15<58:08, 45.90s/it]loss: 2.08264 weighted data loss: 0.00025 weighted f err: -0.00018 weighted ic err: 0.41606 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.32830 :  25% 25/100 [18:15<58:23, 46.71s/it]loss: 3.61257 weighted data loss: 0.00027 weighted f err: -0.00058 weighted ic err: 0.72209 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.27998 :  25% 25/100 [19:13<58:23, 46.71s/it]loss: 3.61257 weighted data loss: 0.00027 weighted f err: -0.00058 weighted ic err: 0.72209 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.27998 :  26% 26/100 [19:13<58:58, 47.82s/it]loss: 6.85563 weighted data loss: 0.00029 weighted f err: 0.00022 weighted ic err: 1.37049 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.18251 :  26% 26/100 [20:11<58:58, 47.82s/it] loss: 6.85563 weighted data loss: 0.00029 weighted f err: 0.00022 weighted ic err: 1.37049 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.18251 :  27% 27/100 [20:11<59:30, 48.91s/it]loss: 14.76553 weighted data loss: 0.00069 weighted f err: -0.00091 weighted ic err: 2.95191 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.16133 :  27% 27/100 [21:10<59:30, 48.91s/it]loss: 14.76553 weighted data loss: 0.00069 weighted f err: -0.00091 weighted ic err: 2.95191 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.16133 :  28% 28/100 [21:10<59:57, 49.97s/it]loss: 39.57722 weighted data loss: 0.00192 weighted f err: -0.00022 weighted ic err: 7.91164 L2 data loss: 0.06766 L2 ic loss: 0.00745 L2 f loss: 0.27230 :  28% 28/100 [22:08<59:57, 49.97s/it]loss: 39.57722 weighted data loss: 0.00192 weighted f err: -0.00022 weighted ic err: 7.91164 L2 data loss: 0.06766 L2 ic loss: 0.00745 L2 f loss: 0.27230 :  29% 29/100 [22:08<1:00:12, 50.88s/it]loss: 39.57722 weighted data loss: 0.00192 weighted f err: -0.00022 weighted ic err: 7.91164 L2 data loss: 0.06766 L2 ic loss: 0.00745 L2 f loss: 0.27230 :  29% 29/100 [22:51<55:58, 47.30s/it]  
Traceback (most recent call last):
  File "/groups/tensorlab/rgundaka/code/CPINO/run.py", line 96, in <module>
    model.step(cur_loss)
  File "/central/groups/tensorlab/rgundaka/code/CPINO/model/CPINO.py", line 47, in step
    self.optimizer.step(loss=loss["loss"])
  File "/home/rgundaka/miniconda3/envs/CPINO/lib/python3.10/site-packages/CGDs/cgd.py", line 103, in step
    hvp_x_vec = Hvp_vec(grad_y_vec, self.max_params, grad_y_vec_d,
  File "/home/rgundaka/miniconda3/envs/CPINO/lib/python3.10/site-packages/CGDs/cgd_utils.py", line 114, in Hvp_vec
    raise ValueError('hvp Nan')
ValueError: hvp Nan
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.017 MB of 0.017 MB uploaded (0.000 MB deduped)wandb: \ 0.017 MB of 0.017 MB uploaded (0.000 MB deduped)wandb: | 0.017 MB of 0.022 MB uploaded (0.000 MB deduped)wandb: / 0.017 MB of 0.022 MB uploaded (0.000 MB deduped)wandb: - 0.017 MB of 0.022 MB uploaded (0.000 MB deduped)wandb: \ 0.022 MB of 0.022 MB uploaded (0.000 MB deduped)wandb: | 0.022 MB of 0.022 MB uploaded (0.000 MB deduped)wandb: / 0.022 MB of 0.022 MB uploaded (0.000 MB deduped)wandb: - 0.022 MB of 0.022 MB uploaded (0.000 MB deduped)wandb: \ 0.022 MB of 0.022 MB uploaded (0.000 MB deduped)wandb: | 0.022 MB of 0.022 MB uploaded (0.000 MB deduped)wandb:                                                                                
wandb: 
wandb: Run history:
wandb:       train L2 data loss â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb:          train L2 f loss â–‡â–ˆâ–†â–…â–…â–†â–†â–…â–„â–„â–„â–„â–ƒâ–ƒâ–‚â–‚â–‚â–‚â–â–‚â–‚â–â–â–‚â–‚â–â–â–â–
wandb:         train L2 ic loss â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb:               train loss â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–„â–ˆ
wandb: train weighted data loss â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–„â–ˆ
wandb:     train weighted f err â–ˆâ–„â–â–„â–†â–…â–ƒâ–ƒâ–„â–„â–„â–„â–…â–…â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–„â–…â–†â–„â–ƒâ–…â–ƒâ–„
wandb:    train weighted ic err â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–„â–ˆ
wandb: 
wandb: Run summary:
wandb:       train L2 data loss 0.06766
wandb:          train L2 f loss 0.2723
wandb:         train L2 ic loss 0.00745
wandb:               train loss 39.57722
wandb: train weighted data loss 0.00192
wandb:     train weighted f err -0.00022
wandb:    train weighted ic err 7.91164
wandb: 
wandb: Synced splendid-lion-15: https://wandb.ai/rishigundakaram/CPINO-wave1D/runs/3lq3i8dz
wandb: Synced 7 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20220627_223633-3lq3i8dz/logs
srun: error: hpc-25-17: task 0: Exited with exit code 1
