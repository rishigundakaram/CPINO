/home/rgundaka/miniconda3/envs/CPINO/lib/python3.10/site-packages/torch/functional.py:568: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  ../aten/src/ATen/native/TensorShape.cpp:2228.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
wandb: Currently logged in as: rishigundakaram. Use `wandb login --relogin` to force relogin
loading data
data is loaded
using device: cuda:0
wandb: wandb version 0.12.19 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.12.18
wandb: Run data is saved locally in /central/groups/tensorlab/rgundaka/code/CPINO/experiments/wave1D_CPINO/wandb/run-20220628_174353-ymq4slin
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run apricot-meadow-21
wandb: â­ï¸ View project at https://wandb.ai/rishigundakaram/CPINO-wave1D
wandb: ğŸš€ View run at https://wandb.ai/rishigundakaram/CPINO-wave1D/runs/ymq4slin
  0% 0/500 [00:00<?, ?it/s]loss: 0.00150 weighted data loss: -0.00013 weighted f err: 0.00223 weighted ic err: 0.00012 L2 data loss: 0.08284 L2 ic loss: 0.00837 L2 f loss: 1.35504 :   0% 0/500 [00:40<?, ?it/s]loss: 0.00150 weighted data loss: -0.00013 weighted f err: 0.00223 weighted ic err: 0.00012 L2 data loss: 0.08284 L2 ic loss: 0.00837 L2 f loss: 1.35504 :   0% 1/500 [00:40<5:35:40, 40.36s/it]loss: 0.00321 weighted data loss: 0.00018 weighted f err: -0.00082 weighted ic err: 0.00045 L2 data loss: 0.07189 L2 ic loss: 0.00771 L2 f loss: 1.93465 :   0% 1/500 [01:20<5:35:40, 40.36s/it]loss: 0.00321 weighted data loss: 0.00018 weighted f err: -0.00082 weighted ic err: 0.00045 L2 data loss: 0.07189 L2 ic loss: 0.00771 L2 f loss: 1.93465 :   0% 2/500 [01:20<5:34:18, 40.28s/it]loss: 0.00532 weighted data loss: -0.00006 weighted f err: 0.00066 weighted ic err: 0.00104 L2 data loss: 0.06997 L2 ic loss: 0.00759 L2 f loss: 1.19041 :   0% 2/500 [02:00<5:34:18, 40.28s/it]loss: 0.00532 weighted data loss: -0.00006 weighted f err: 0.00066 weighted ic err: 0.00104 L2 data loss: 0.06997 L2 ic loss: 0.00759 L2 f loss: 1.19041 :   1% 3/500 [02:00<5:32:37, 40.16s/it]loss: 0.00776 weighted data loss: 0.00005 weighted f err: -0.00006 weighted ic err: 0.00146 L2 data loss: 0.06815 L2 ic loss: 0.00749 L2 f loss: 1.29140 :   1% 3/500 [02:40<5:32:37, 40.16s/it]loss: 0.00776 weighted data loss: 0.00005 weighted f err: -0.00006 weighted ic err: 0.00146 L2 data loss: 0.06815 L2 ic loss: 0.00749 L2 f loss: 1.29140 :   1% 4/500 [02:40<5:31:58, 40.16s/it]loss: 0.01009 weighted data loss: -0.00005 weighted f err: 0.00017 weighted ic err: 0.00208 L2 data loss: 0.06792 L2 ic loss: 0.00748 L2 f loss: 0.86626 :   1% 4/500 [03:20<5:31:58, 40.16s/it]loss: 0.01009 weighted data loss: -0.00005 weighted f err: 0.00017 weighted ic err: 0.00208 L2 data loss: 0.06792 L2 ic loss: 0.00748 L2 f loss: 0.86626 :   1% 5/500 [03:20<5:31:14, 40.15s/it]loss: 0.01285 weighted data loss: 0.00004 weighted f err: -0.00001 weighted ic err: 0.00249 L2 data loss: 0.06777 L2 ic loss: 0.00747 L2 f loss: 0.93426 :   1% 5/500 [04:01<5:31:14, 40.15s/it]loss: 0.01285 weighted data loss: 0.00004 weighted f err: -0.00001 weighted ic err: 0.00249 L2 data loss: 0.06777 L2 ic loss: 0.00747 L2 f loss: 0.93426 :   1% 6/500 [04:01<5:30:45, 40.17s/it]loss: 0.01561 weighted data loss: -0.00006 weighted f err: -0.00007 weighted ic err: 0.00326 L2 data loss: 0.06771 L2 ic loss: 0.00747 L2 f loss: 0.62120 :   1% 6/500 [04:41<5:30:45, 40.17s/it]loss: 0.01561 weighted data loss: -0.00006 weighted f err: -0.00007 weighted ic err: 0.00326 L2 data loss: 0.06771 L2 ic loss: 0.00747 L2 f loss: 0.62120 :   1% 7/500 [04:41<5:29:50, 40.14s/it]loss: 0.01897 weighted data loss: 0.00001 weighted f err: -0.00003 weighted ic err: 0.00378 L2 data loss: 0.06770 L2 ic loss: 0.00747 L2 f loss: 0.77009 :   1% 7/500 [05:21<5:29:50, 40.14s/it] loss: 0.01897 weighted data loss: 0.00001 weighted f err: -0.00003 weighted ic err: 0.00378 L2 data loss: 0.06770 L2 ic loss: 0.00747 L2 f loss: 0.77009 :   2% 8/500 [05:21<5:29:14, 40.15s/it]loss: 0.02271 weighted data loss: -0.00003 weighted f err: -0.00002 weighted ic err: 0.00461 L2 data loss: 0.06773 L2 ic loss: 0.00747 L2 f loss: 0.62291 :   2% 8/500 [06:01<5:29:14, 40.15s/it]loss: 0.02271 weighted data loss: -0.00003 weighted f err: -0.00002 weighted ic err: 0.00461 L2 data loss: 0.06773 L2 ic loss: 0.00747 L2 f loss: 0.62291 :   2% 9/500 [06:01<5:28:27, 40.14s/it]loss: 0.02691 weighted data loss: -0.00006 weighted f err: 0.00010 weighted ic err: 0.00549 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.42541 :   2% 9/500 [06:41<5:28:27, 40.14s/it] loss: 0.02691 weighted data loss: -0.00006 weighted f err: 0.00010 weighted ic err: 0.00549 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.42541 :   2% 10/500 [06:41<5:27:31, 40.10s/it]loss: 0.03170 weighted data loss: -0.00002 weighted f err: -0.00002 weighted ic err: 0.00638 L2 data loss: 0.06768 L2 ic loss: 0.00746 L2 f loss: 0.46045 :   2% 10/500 [07:21<5:27:31, 40.10s/it]loss: 0.03170 weighted data loss: -0.00002 weighted f err: -0.00002 weighted ic err: 0.00638 L2 data loss: 0.06768 L2 ic loss: 0.00746 L2 f loss: 0.46045 :   2% 11/500 [07:21<5:26:53, 40.11s/it]loss: 0.03729 weighted data loss: -0.00007 weighted f err: -0.00004 weighted ic err: 0.00760 L2 data loss: 0.06768 L2 ic loss: 0.00746 L2 f loss: 0.37175 :   2% 11/500 [08:01<5:26:53, 40.11s/it]loss: 0.03729 weighted data loss: -0.00007 weighted f err: -0.00004 weighted ic err: 0.00760 L2 data loss: 0.06768 L2 ic loss: 0.00746 L2 f loss: 0.37175 :   2% 12/500 [08:01<5:26:39, 40.16s/it]loss: 0.04392 weighted data loss: -0.00009 weighted f err: -0.00001 weighted ic err: 0.00897 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.18872 :   2% 12/500 [08:41<5:26:39, 40.16s/it]loss: 0.04392 weighted data loss: -0.00009 weighted f err: -0.00001 weighted ic err: 0.00897 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.18872 :   3% 13/500 [08:41<5:25:50, 40.15s/it]loss: 0.05183 weighted data loss: -0.00009 weighted f err: -0.00006 weighted ic err: 0.01056 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.28649 :   3% 13/500 [09:22<5:25:50, 40.15s/it]loss: 0.05183 weighted data loss: -0.00009 weighted f err: -0.00006 weighted ic err: 0.01056 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.28649 :   3% 14/500 [09:22<5:25:40, 40.21s/it]loss: 0.06141 weighted data loss: -0.00011 weighted f err: -0.00011 weighted ic err: 0.01252 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.26355 :   3% 14/500 [10:02<5:25:40, 40.21s/it]loss: 0.06141 weighted data loss: -0.00011 weighted f err: -0.00011 weighted ic err: 0.01252 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.26355 :   3% 15/500 [10:02<5:25:07, 40.22s/it]loss: 0.07315 weighted data loss: -0.00014 weighted f err: -0.00016 weighted ic err: 0.01495 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.23736 :   3% 15/500 [10:44<5:25:07, 40.22s/it]loss: 0.07315 weighted data loss: -0.00014 weighted f err: -0.00016 weighted ic err: 0.01495 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.23736 :   3% 16/500 [10:44<5:25:57, 40.41s/it]loss: 0.08777 weighted data loss: -0.00019 weighted f err: -0.00025 weighted ic err: 0.01798 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.22776 :   3% 16/500 [11:26<5:25:57, 40.41s/it]loss: 0.08777 weighted data loss: -0.00019 weighted f err: -0.00025 weighted ic err: 0.01798 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.22776 :   3% 17/500 [11:26<5:26:28, 40.56s/it]loss: 0.10629 weighted data loss: -0.00024 weighted f err: -0.00037 weighted ic err: 0.02180 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.25531 :   3% 17/500 [12:09<5:26:28, 40.56s/it]loss: 0.10629 weighted data loss: -0.00024 weighted f err: -0.00037 weighted ic err: 0.02180 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.25531 :   4% 18/500 [12:09<5:28:37, 40.91s/it]loss: 0.13012 weighted data loss: -0.00027 weighted f err: -0.00056 weighted ic err: 0.02667 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.29600 :   4% 18/500 [12:54<5:28:37, 40.91s/it]loss: 0.13012 weighted data loss: -0.00027 weighted f err: -0.00056 weighted ic err: 0.02667 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.29600 :   4% 19/500 [12:54<5:31:12, 41.32s/it]loss: 0.16145 weighted data loss: -0.00032 weighted f err: -0.00078 weighted ic err: 0.03308 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.25455 :   4% 19/500 [13:40<5:31:12, 41.32s/it]loss: 0.16145 weighted data loss: -0.00032 weighted f err: -0.00078 weighted ic err: 0.03308 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.25455 :   4% 20/500 [13:40<5:35:03, 41.88s/it]loss: 0.20354 weighted data loss: -0.00043 weighted f err: -0.00113 weighted ic err: 0.04180 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.18552 :   4% 20/500 [14:28<5:35:03, 41.88s/it]loss: 0.20354 weighted data loss: -0.00043 weighted f err: -0.00113 weighted ic err: 0.04180 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.18552 :   4% 21/500 [14:28<5:39:43, 42.55s/it]loss: 0.26156 weighted data loss: -0.00054 weighted f err: -0.00162 weighted ic err: 0.05371 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.22987 :   4% 21/500 [15:17<5:39:43, 42.55s/it]loss: 0.26156 weighted data loss: -0.00054 weighted f err: -0.00162 weighted ic err: 0.05371 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.22987 :   4% 22/500 [15:17<5:44:28, 43.24s/it]loss: 0.34384 weighted data loss: -0.00070 weighted f err: -0.00228 weighted ic err: 0.07063 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.27331 :   4% 22/500 [16:06<5:44:28, 43.24s/it]loss: 0.34384 weighted data loss: -0.00070 weighted f err: -0.00228 weighted ic err: 0.07063 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.27331 :   5% 23/500 [16:06<5:49:13, 43.93s/it]loss: 0.46475 weighted data loss: -0.00094 weighted f err: -0.00304 weighted ic err: 0.09543 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.33435 :   5% 23/500 [16:56<5:49:13, 43.93s/it]loss: 0.46475 weighted data loss: -0.00094 weighted f err: -0.00304 weighted ic err: 0.09543 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.33435 :   5% 24/500 [16:56<5:53:42, 44.59s/it]loss: 0.64987 weighted data loss: -0.00131 weighted f err: -0.00360 weighted ic err: 0.13331 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.40673 :   5% 24/500 [17:48<5:53:42, 44.59s/it]loss: 0.64987 weighted data loss: -0.00131 weighted f err: -0.00360 weighted ic err: 0.13331 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.40673 :   5% 25/500 [17:48<5:59:15, 45.38s/it]loss: 0.94751 weighted data loss: -0.00191 weighted f err: -0.00319 weighted ic err: 0.19397 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.47740 :   5% 25/500 [18:43<5:59:15, 45.38s/it]loss: 0.94751 weighted data loss: -0.00191 weighted f err: -0.00319 weighted ic err: 0.19397 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.47740 :   5% 26/500 [18:43<6:06:53, 46.44s/it]loss: 1.45197 weighted data loss: -0.00295 weighted f err: -0.00061 weighted ic err: 0.29641 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.50237 :   5% 26/500 [19:43<6:06:53, 46.44s/it]loss: 1.45197 weighted data loss: -0.00295 weighted f err: -0.00061 weighted ic err: 0.29641 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.50237 :   5% 27/500 [19:43<6:16:46, 47.79s/it]loss: 2.35870 weighted data loss: -0.00471 weighted f err: 0.00334 weighted ic err: 0.48050 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.46650 :   5% 27/500 [20:43<6:16:46, 47.79s/it] loss: 2.35870 weighted data loss: -0.00471 weighted f err: 0.00334 weighted ic err: 0.48050 L2 data loss: 0.06765 L2 ic loss: 0.00746 L2 f loss: 0.46650 :   6% 28/500 [20:43<6:26:18, 49.11s/it]loss: 4.11703 weighted data loss: -0.00817 weighted f err: 0.00397 weighted ic err: 0.83896 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.39442 :   6% 28/500 [21:44<6:26:18, 49.11s/it]loss: 4.11703 weighted data loss: -0.00817 weighted f err: 0.00397 weighted ic err: 0.83896 L2 data loss: 0.06766 L2 ic loss: 0.00746 L2 f loss: 0.39442 :   6% 29/500 [21:44<6:35:19, 50.36s/it]loss: 7.91510 weighted data loss: -0.01616 weighted f err: -0.00148 weighted ic err: 1.61563 L2 data loss: 0.06765 L2 ic loss: 0.00745 L2 f loss: 0.37401 :   6% 29/500 [22:45<6:35:19, 50.36s/it]loss: 7.91510 weighted data loss: -0.01616 weighted f err: -0.00148 weighted ic err: 1.61563 L2 data loss: 0.06765 L2 ic loss: 0.00745 L2 f loss: 0.37401 :   6% 30/500 [22:45<6:43:11, 51.47s/it]loss: 17.42234 weighted data loss: -0.03569 weighted f err: -0.00404 weighted ic err: 3.55666 L2 data loss: 0.06765 L2 ic loss: 0.00743 L2 f loss: 0.56603 :   6% 30/500 [23:46<6:43:11, 51.47s/it]loss: 17.42234 weighted data loss: -0.03569 weighted f err: -0.00404 weighted ic err: 3.55666 L2 data loss: 0.06765 L2 ic loss: 0.00743 L2 f loss: 0.56603 :   6% 31/500 [23:46<6:49:50, 52.43s/it]loss: 17.42234 weighted data loss: -0.03569 weighted f err: -0.00404 weighted ic err: 3.55666 L2 data loss: 0.06765 L2 ic loss: 0.00743 L2 f loss: 0.56603 :   6% 31/500 [24:33<6:11:31, 47.53s/it]
Traceback (most recent call last):
  File "/groups/tensorlab/rgundaka/code/CPINO/run.py", line 96, in <module>
    model.step(cur_loss)
  File "/central/groups/tensorlab/rgundaka/code/CPINO/model/CPINO.py", line 48, in step
    self.optimizer.step(loss=loss["loss"])
  File "/home/rgundaka/miniconda3/envs/CPINO/lib/python3.10/site-packages/CGDs/cgd.py", line 116, in step
    cg_y, iter_num = conjugate_gradient(grad_x=grad_y_vec,
  File "/home/rgundaka/miniconda3/envs/CPINO/lib/python3.10/site-packages/CGDs/cgd_utils.py", line 65, in conjugate_gradient
    h_2 = Hvp_vec(grad_vec=grad_y, params=x_params, vec=h_1, retain_graph=True).detach_().mul(lr_x)
  File "/home/rgundaka/miniconda3/envs/CPINO/lib/python3.10/site-packages/CGDs/cgd_utils.py", line 114, in Hvp_vec
    raise ValueError('hvp Nan')
ValueError: hvp Nan
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: \ 0.019 MB of 0.022 MB uploaded (0.000 MB deduped)wandb: | 0.019 MB of 0.024 MB uploaded (0.000 MB deduped)wandb: / 0.024 MB of 0.024 MB uploaded (0.000 MB deduped)wandb: - 0.024 MB of 0.024 MB uploaded (0.000 MB deduped)wandb: \ 0.024 MB of 0.024 MB uploaded (0.000 MB deduped)wandb: | 0.024 MB of 0.024 MB uploaded (0.000 MB deduped)wandb: / 0.024 MB of 0.024 MB uploaded (0.000 MB deduped)wandb: - 0.024 MB of 0.024 MB uploaded (0.000 MB deduped)wandb: \ 0.024 MB of 0.024 MB uploaded (0.000 MB deduped)wandb:                                                                                
wandb: 
wandb: Run history:
wandb:       train L2 data loss â–ˆâ–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb:          train L2 f loss â–†â–ˆâ–…â–…â–„â–„â–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–ƒ
wandb:         train L2 ic loss â–ˆâ–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb:               train loss â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–ƒâ–„â–ˆ
wandb: train weighted data loss â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–†â–…â–
wandb:     train weighted f err â–†â–„â–…â–„â–…â–…â–„â–…â–…â–…â–…â–„â–…â–„â–„â–„â–„â–„â–„â–„â–„â–ƒâ–ƒâ–‚â–â–‚â–„â–‡â–ˆâ–ƒâ–
wandb:    train weighted ic err â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–ƒâ–„â–ˆ
wandb: 
wandb: Run summary:
wandb:       train L2 data loss 0.06765
wandb:          train L2 f loss 0.56603
wandb:         train L2 ic loss 0.00743
wandb:               train loss 17.42234
wandb: train weighted data loss -0.03569
wandb:     train weighted f err -0.00404
wandb:    train weighted ic err 3.55666
wandb: 
wandb: Synced apricot-meadow-21: https://wandb.ai/rishigundakaram/CPINO-wave1D/runs/ymq4slin
wandb: Synced 7 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20220628_174353-ymq4slin/logs
srun: error: hpc-23-34: task 0: Exited with exit code 1
